syntax = "proto3";

option go_package = "./pb";

package pb;

message IDRequest {
  uint64 id = 1;
}

message IDsRequest {
  repeated uint64 ids = 1;
}

message NoDataResponse {}

message PageInfo {
  uint64 pageNo = 1;
  uint64 pageSize = 2;
  uint64 cursor = 3;
}

message Model {
  uint64 id = 1;
  uint64 createdAt = 2;
  uint64 updatedAt = 3;
  uint64 deletedAt = 4;
}


message UsernameRequest {
  string username = 1;
}

message UserInfo {
//   uint64 id = 1; //  可以设置不能为空
    uint64 id = 1;
    uint64 status = 2;
    string username = 3;
    string password = 4;
    string nickname = 5;
    string description = 6;
    string homePath = 7;
    repeated uint64 roleIds = 8;
    string mobile = 9;
    string email = 10;
    string avatar = 11;
    uint64 departmentId = 12;
    repeated uint64 positionIds = 13;
    repeated string roleCodes = 14;
    repeated string roleName = 15;
    string departmentName = 16;

    uint64 createdAt = 17;
    uint64 updatedAt = 18;
}

message UsernameResponse {
  UserInfo userInfo = 1;
}

message TokenInfo {
   uint64 id = 1;
   uint64 status = 2;
   uint64 userId = 3;
   string username = 4;
   string token = 5;
   string source = 6;
   uint64 expiredAt = 7;
   uint64 createdAt = 8;
   uint64 updatedAt = 9;
}

message TokenInfoRequest {
  TokenInfo tokenInfo = 1;
}

message TokenInfoResponse {
  uint64 id = 1;
  string token = 2;
}

message UserInfoResponse {
  UserInfo userInfo = 1;
}

message MenuInfo {
   uint64 id = 1;
   uint64 level = 2;
   uint64 parentId = 3;
   string path = 4;
   string name = 5;
   string redirect = 6;
   string component = 7;
   uint64 sort = 8;
   bool disabled = 9;
   uint64 menuType = 10;
   string serviceName = 11;
   string permission = 12;
   Meta meta = 13;

   uint64 createdAt = 14;
   uint64 updatedAt = 15;
   uint64 deletedAt = 16;
}

message Meta {
   string title = 1;
   string icon = 2;
   bool hideMenu = 3;
   bool hideBreadcrumb = 4;
   bool ignoreKeepAlive = 5;
   bool hideTab = 6;
   string frameSrc = 7;
   bool carryParam = 8;
   bool hideChildrenInMenu = 9;
   bool affix = 10;
   uint64 dynamicLevel = 11;
   string realPath = 12;
}

message MenuInfoList {
  uint64 total = 1;
  repeated MenuInfo menuInfo = 2;
}

message RoleInfo {
  Model model = 1;
  uint64 status = 2;
  string name = 3;
  string code = 4;
  string remark = 5;
  uint64 sort = 6;
  string defaultRouter = 7;

}

message RoleListRequest {
  PageInfo pageInfo = 1;
  string name = 2;
  string code = 3;
  uint64 Id = 4;
}
message RoleListResponse {
  uint64 total = 1;
  uint64 cursor = 2;
  repeated RoleInfo roleInfo = 3;
}
message RoleUpdateRequest {
  uint64 id = 1;  // 必须字段
  optional string name = 2;
  optional string code = 3;
  optional string remark = 4;
  optional uint64 status = 5;
  optional uint64 sort = 6;
  optional string defaultRouter = 7;
}




//=============================== 隔离结构体 ===========================
//=============================== user ===========================

service User {
  // 根据用户名获取用户详情
  rpc getUserByUsername (UsernameRequest) returns (UsernameResponse);

  //获取用户详细信息
  rpc getUserInfoById (IDRequest) returns (UserInfoResponse);
}

//=============================== Token ===========================
service Token {
  // 生成Token
  rpc createToken (TokenInfoRequest) returns (TokenInfoResponse);
}


//=============================== Menu ===========================
service Menu {
  // 根据角色id 获取菜单 -- 目前系统用这个 可以方便用户切换角色获取不一样的菜单
  rpc getMenuListByRoleId (IDRequest) returns (MenuInfoList);

  // 根据角色ids 获取菜单
  //  rpc getMenuListByRoleIds (IDSReq) returns (MenuInfoList);

  // 获取菜单列表
  rpc getMenuList (PageInfo) returns (MenuInfoList);
}


//=============================== Role ===========================
service Role {

  // 获取角色列表
  rpc getRoleList (RoleListRequest) returns (RoleListResponse);
  // 创建新角色
  rpc createRole (RoleInfo) returns (NoDataResponse);
  // 删除角色信息
  rpc deleteRole (IDsRequest) returns (NoDataResponse);
  // 更新角色
  rpc updateRole (RoleUpdateRequest) returns (NoDataResponse);
  // 通过ID获取角色
  rpc getRoleById (IDRequest) returns (NoDataResponse);



}